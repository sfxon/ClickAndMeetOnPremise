<?php

use PHPMailer\PHPMailer\PHPMailer;
use PHPMailer\PHPMailer\Exception;

class mvPhpMailer extends cModule {
		public $mail = false;
		
		/////////////////////////////////////////////////////////////////////////////////
		// Verarbeitung..
		/////////////////////////////////////////////////////////////////////////////////
		public function init() {
				require_once('mail.php');
				
				$smtpUsername = '';
				$smtpPassword = '';
				
				$mail = new PHPMailer;
				//$mail->isSMTP(); 
				$mail->SMTPDebug = 0; // 0 = off (for production use) - 1 = client messages - 2 = client and server messages
				$mail->Host = ''; // use $mail->Host = gethostbyname('smtp.gmail.com'); // if your network does not support SMTP over IPv6
				$mail->Port = 587; // TLS only
				$mail->SMTPSecure = 'tls'; // ssl is depracated
				$mail->SMTPAuth = true;
				$mail->Username = $smtpUsername;
				$mail->Password = $smtpPassword;
				
				$this->mail = $mail;
				
				
				
				
				
				//$this->mail = $mail;
		}
		
		/////////////////////////////////////////////////////////////////////////////////
		// Absender festlegen.
		/////////////////////////////////////////////////////////////////////////////////
		public function setFrom($emailFrom, $emailFromName) {
				$this->mail->setFrom($emailFrom, $emailFromName);
		}
		
		/////////////////////////////////////////////////////////////////////////////////
		// Empfänger hinzufügen.
		/////////////////////////////////////////////////////////////////////////////////
		public function addAddress($emailTo, $emailToName) {
				$this->mail->addAddress($emailTo, $emailToName);
		}
		
		/////////////////////////////////////////////////////////////////////////////////
		// CC Empfänger hinzufügen.
		/////////////////////////////////////////////////////////////////////////////////
		public function addCC($emailTo, $emailToName) {
				$this->mail->AddCC($emailTo, $emailToName);
		}
		
		/////////////////////////////////////////////////////////////////////////////////
		// Betreff festlegen.
		/////////////////////////////////////////////////////////////////////////////////
		public function setSubject($subject) {
				$this->mail->Subject = $subject;
		}
		
		/////////////////////////////////////////////////////////////////////////////////
		// HTML festlegen.
		/////////////////////////////////////////////////////////////////////////////////
		public function setHTML($html) {
				$this->mail->msgHTML($html);
		}
		
		/////////////////////////////////////////////////////////////////////////////////
		// Plain Text festlegen.
		/////////////////////////////////////////////////////////////////////////////////
		public function setPlainText($text) {
				$this->mail->AltBody = $text;
		}
		
		/////////////////////////////////////////////////////////////////////////////////
		// Anhang hinzufügen.
		/////////////////////////////////////////////////////////////////////////////////
		public function addAttachment($file_and_path) {
				$this->mail->addAttachment($file_and_path); //Attach an image file
		}
		
		/////////////////////////////////////////////////////////////////////////////////
		// Anhang hinzufügen.
		/////////////////////////////////////////////////////////////////////////////////
		public function send() {
				if(!$this->mail->send()){
						//echo "Mailer Error: " . $this->mail->ErrorInfo;
						//die;
				}else{
						//echo "Message sent!";
				}
		}
}

